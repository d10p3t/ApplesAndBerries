extends layout

block content
	//- ul.custom-menu
	//- 	li(data-action="edit") Edit
	//- 	li(data-action="delete") Delete
	.ui.middle.center.aligned.grid.stackable.doubling
		// Title
		.fifteen.wide.column#menu-row(style="padding:5; margin:5; !important")
			.ui.segment.center.floated.column(style="width: 100%; margin: 75 5 5 5; border-radius: 0px !important; ")
				.ui.container.left.floated
					h1 Employees
		.fifteen.wide.column(style = "padding: 5 5 0 5 !important")
			button.ui.button.right.floated.column(onclick="location.replace('/employees/add')") ADD
		//- 		//- button.ui.button(onclick="location.replace('/employees/editEmployee')") EDIT
				//- button.ui.button(onclick="location.replace('/employees/delete')") DELETE

		//Table Proper
		.row
			.ui.container(style="overflow-y:scroll; height: 60vh;")
				table#employee-view-table.ui.very.basic.table.sortable.selectable
					thead
						tr(style="background-color: #")
							th eID
							th Name
							th Start Date
							th Birthday
							th Position
							th Status
							th Dependents
							th Salary
					tbody
						for employee in employees
							tr.employee
								td(data-eid=employee.eID)= employee.eID
								td= employee.name
								td= employee.startDate
								td= employee.birthday
								if employee.position == 0
									td Teacher
								else if employee.position == 1
									td Admin
								else if employee.position == 2
									td Staff
								if employee.status == 0
									td Single
								else if employee.status == 1
									td Marries
								td= employee.dependents
								td= employee.salary
	//- .row
	//- 	div(style='padding: 2%')
	//- 		button.ui.right.floated.button(onclick="location.replace('/employees/add')") ADD
	.ui.small.modal
		.header Confirm
		.content
			| Confirm Delete Employee
		.actions
			.ui.positive.submit.right.button OK
		
	script(src="http://www.kryogenix.org/code/browser/sorttable/sorttable.js")
	script(type='text/javascript').
		var eID = -1;
		// Trigger action when the contexmenu is about to be shown
		$('tr').on("contextmenu", function (event) {
			eID = parseInt($(this).children().first().attr('data-eid'));
			// Avoid the real one
			event.preventDefault();
			// Show contextmenu
			$(".custom-menu").finish().toggle(100).
			// In the right position (the mouse)
			css({
				top: event.pageY - 13 + "px",
				left: event.pageX + "px"
			});
		});


		// If the document is clicked somewhere
		$(document).bind("mousedown", function (e) {
			// If the clicked element is not the menu
			if (!$(e.target).parents(".custom-menu").length > 0) {
				// Hide it
				$(".custom-menu").hide(100);
			}
		});


		// If the menu element is clicked
		$(".custom-menu li").click(function(){
			// This is the triggered action name
			switch($(this).attr("data-action")) {
				// A case for each action. Your actions here
				case "edit":
					window.location = '/employees/editEmployee?eID=' + eID;
					//- alert($(this).parent().attr('data-eid'));
					break;
				case "delete":
					$('.small.modal').modal('show');
					break;
			}			
				// Hide it AFTER the action was triggered
			$(".custom-menu").hide(100);
		});

		$('.submit').click(function(){
			$.post('/employees/deleteEmployee', {
				eID: eID
			}, function(){
				alert('delete success!');
				window.location.reload();
			});
		})